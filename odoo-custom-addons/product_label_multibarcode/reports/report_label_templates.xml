<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_label_barcode_document">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="w">
                <style>
                    .label-grid { display: flex; flex-wrap: wrap; }
                    .label-item {
                        box-sizing: border-box;
                        width: calc(100% / [[w.label_cols or 3]]);
                        padding: 6px 8px;
                        border: 0;
                    }
                    .lbl-title { font-size: 11px; line-height: 14px; font-weight: 600; }
                    .lbl-uom { font-size: 10px; color: #555; }
                    .lbl-barcode { margin-top: 4px; }
                </style>
                <div class="label-grid">
                    <t t-foreach="w.line_ids.filtered(lambda l: l.select and l.qty and l.qty > 0)" t-as="line">
                        <t t-foreach="range(line.qty)" t-as="i">
                            <div class="label-item">
                                <div class="lbl-title">
                                    <t t-esc="line.display_name or (line.product_id.display_name or line.product_tmpl_id.display_name)"/>
                                </div>
                                <t t-if="line.uom_id">
                                    <div class="lbl-uom">UoM: <t t-esc="line.uom_id.name"/></div>
                                </t>
                                <div class="lbl-barcode">
                                    <barcode t-att-code="line.barcode"
                                             t-att-type="w.barcode_type"
                                             t-att-humanreadable="1 if w.include_humanreadable else 0"/>
                                </div>
                            </div>
                        </t>
                    </t>
                </div>
            </t>
        </t>
    </template>

    <record id="action_report_label_barcode" model="ir.actions.report">
        <field name="name">Product Labels (Multi-UoM)</field>
        <field name="model">label.barcode.wizard</field>
        <field name="report_name">product_label_multibarcode.report_label_barcode_document</field>
        <field name="report_type">qweb-pdf</field>
    </record>
</odoo>
