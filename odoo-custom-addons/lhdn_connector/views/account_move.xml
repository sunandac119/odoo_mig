<odoo>
    <data>
        <record id="view_move_forms_inherited" model="ir.ui.view">
            <field name="name">view.move.forms.inherited</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_move_form"/>
            <field name="arch" type="xml">

                <xpath expr="//form/header" position="after">
                    <div class="alert alert-danger" role="alert" style="width:100%"
                         attrs="{'invisible': [('lhdn_documents_error','in', [False,'']), ('lhdn_invoice_status', '!=', 'error')]}">
                        <field name="lhdn_documents_error" readonly="1" force_save="1"/>
                    </div>
                </xpath>

                <xpath expr="//form/header/button[@name='button_cancel']" position="after">
                    <button string="e-Invoice Validate" class="oe_highlight" name="e_invoice_validate" type="object"
                            attrs="{'invisible': [
                           '|', '|', '|',
                           ('move_type', 'in', ['entry', 'in_invoice', 'in_refund', 'out_receipt', 'in_receipt', 'out_refund']),
                           ('lhdn_invoice_status', 'in', ['validated', 'cancelled']),
                           ('state', 'in', ['draft', 'cancel']),
                           ('lhdn_uuid', '!=', False)
                       ]}"/>
                    <button string="e-Credit Note Validate" class="oe_highlight" name="e_invoice_validate" type="object"
                             attrs="{'invisible': [
                           '|', '|', '|',
                           ('move_type', 'in', ['entry', 'in_invoice', 'in_refund', 'out_receipt', 'in_receipt', 'out_invoice']),
                           ('lhdn_invoice_status', 'in', ['validated', 'cancelled']),
                           ('state', 'in', ['draft', 'cancel']),
                           ('lhdn_uuid', '!=', False)
                       ]}"/>

                    <button string="Self Billed e-Invoice" class="oe_highlight" name="self_billed_e_invoice"
                            type="object"
                            attrs="{'invisible': [
                           '|', '|', '|',
                           ('move_type', 'in', ['entry', 'out_invoice', 'out_refund', 'out_receipt', 'in_receipt', 'in_refund']),
                           ('lhdn_invoice_status', 'in', ['validated', 'cancelled', 'rejected']),
                           ('state', 'in', ['draft', 'cancel']),
                           ('lhdn_uuid', '!=', False)
                       ]}"/>
                    <button string="Self Billed e-Credit Note" class="oe_highlight" name="self_billed_e_invoice"
                            type="object"
                            attrs="{'invisible': [
                           '|', '|', '|',
                           ('move_type', 'in', ['entry', 'out_invoice', 'out_refund', 'out_receipt', 'in_receipt', 'in_invoice']),
                           ('lhdn_invoice_status', 'in', ['validated', 'cancelled', 'rejected']),
                           ('state', 'in', ['draft', 'cancel']),
                           ('lhdn_uuid', '!=', False)
                       ]}"/>


                    <button string="Cancel e-Invoice" class="oe_highlight" name="cancel_e_invoice"
                            type="object"
                            attrs="{'invisible': [
                           '|',
                           ('lhdn_uuid', '=', False),
                           ('lhdn_invoice_status', 'not in', ['validated'])
                       ]}"/>
                    <button string="Retrive LHDN Bill" class="oe_highlight" name="retrive_lhdn_invoice"
                            type="object"
                            attrs="{'invisible': [
                           '|',
                           ('move_type', 'in', ['entry', 'in_refund', 'out_receipt', 'in_receipt', 'out_invoice', 'out_refund']),
                           ('state', 'not in', ['draft'])
                       ]}"/>

                    <button string="Matching LHDN Bill" class="oe_highlight" name="matching_lhdn_invoice"
                            type="object"
                            attrs="{'invisible': [
                           '|', '|',
                           ('move_type', 'in', ['entry', 'in_refund', 'out_receipt', 'in_receipt', 'out_invoice', 'out_refund']),
                           ('state', 'not in', ['posted']),
                           ('lhdn_invoice_status', '!=', 'new')
                       ]}"/>

                    <button string="Rejection request LHDN Bill" class="oe_highlight"
                            name="rejection_requests_lhdn_invoice"
                            type="object"
                            attrs="{'invisible': [
                           '|', '|', '|', '|',
                           ('move_type', 'in', ['entry', 'in_refund', 'out_receipt', 'in_receipt', 'out_invoice', 'out_refund']),
                           ('state', 'not in', ['posted']),
                           ('is_created_from_lhdn_uuid', '=', False),
                           ('lhdn_uuid', '=', ' '),
                           ('lhdn_invoice_status', '=', 'rejected')
                       ]}"/>
                    <button string="Send To Peppol" class="oe_highlight"
                            name="manually_documents_send_in_peppol_network"
                            type="object"
                            attrs="{'invisible': [
                           '|',
                           ('is_sended_in_peppol', '=', True),
                           ('state', '!=', 'posted')
                       ]}"/>
                    <!--                    lhdn_invoice_status not in ['validated','submitted']-->
                    <button name="action_reverse_debit_note" string="Debit Note" type="object"
                            attrs="{'invisible': [
                           '|',
                           ('move_type', 'not in', ['out_invoice', 'in_invoice']),
                           ('state', '!=', 'posted')
                       ]}"/>
                    <button name="action_reverse_refund_note" string="Refund Note" type="object"
                            attrs="{'invisible': [
                           '|',
                           ('move_type', 'not in', ['out_invoice', 'in_invoice']),
                           ('state', '!=', 'posted')
                       ]}"/>
                </xpath>

                <xpath expr="//field[@name='invoice_date']" position="after">
                    <field name="invoice_issue_time"/>
                    <field name="debit_origin_id" string="Original Invoice" readonly="1" force_save="1"/>
                </xpath>

                <xpath expr="//form/sheet/group[1]" position="after">
                    <group>
                        <group id="peppol_information" string="Peppol Network Information">
                            <field name="is_sended_in_peppol" readonly="1" force_save="1"/>
                            <field name="peppol_xml_attachment" readonly="1" force_save="1"/>
                            <field name="is_created_from_peppol_received_docs" readonly="1" force_save="1"/>
                            <field name="peppol_received_docs_ref" readonly="1" force_save="1"/>
                        </group>

                        <group id="lhdn_information" string="LHDN Information">
                            <field name="lhdn_uuid" attrs="{'readonly': [('lhdn_invoice_status', 'in', ['validated', 'cancelled'])]}"/>
                            <field name="lhdn_submission_uid" readonly="1"/>
                            <label for="lhdn_invoice_status"/>
                            <div class="o_row">
                                <field name="lhdn_invoice_status" readonly="1"/>
                                <button string="Fetch status" name="get_lhdn_documents_status" type="object"
                                        class="oe_highlight"
                                        attrs="{'invisible': [
                                       '|',
                                       '&amp;',
                                       ('lhdn_invoice_status', 'in', ['validated', 'cancelled']),
                                       ('lhdn_uuid', '!=', False),
                                       ('lhdn_uuid', '=', False)
                                   ]}"/>
                            </div>
                            <field name="lhdn_document_cancellation_reason" attrs="{'invisible': [('lhdn_uuid', '=', False)]}"/>
                            <field name="origin_lhdn_uuid" readonly="1" force_save="1"
                                   attrs="{'invisible': [('move_type', 'not in', ['out_refund', 'in_refund'])]}"/>
                            <field name="is_created_from_lhdn_uuid" readonly="1" force_save="1"/>
                            <field name="is_lhdn_pos_retail_combine_invoice" readonly="1" force_save="1"/>
                            <field name="lhdn_json_data" readonly="1" force_save="1"/>
                            <field name="lhdn_xml_attachment" readonly="1" force_save="1"/>
                            <field name="lhdn_longid" invisible="1"/>
                            <field name="lhdn_base_url" invisible="1"/>
                            <field name="is_created_from_ai" readonly="1" force_save="1"/>
                            <field name="portal_ai_inv_number" readonly="1" force_save="1"/>
                        </group>

                    </group>
                </xpath>
            </field>
        </record>
    </data>
</odoo>